function cg = clebsch_gordan(j1,m1,j2,m2,j3,m3)
if m1+m2~=m3 || j3<abs(j1-j2) || j3>j1+j2, cg=0; return; end
tmin=max([0 j2-m1-j3 j1+m2-j3]);
tmax=min([j1+j2-j3 j1-m1 j2+m2]);
sumTerm=0;
for t=tmin:tmax
    sumTerm=sumTerm+ (-1)^t / ...
        (factorial(t)*factorial(j1+j2-j3-t)*factorial(j1-m1-t)* ...
        factorial(j2+m2-t)*factorial(j3-j2+m1+t)*factorial(j3-j1-m2+t));
end
pref=sqrt((2*j3+1)*factorial(j1+j2-j3)*factorial(j1-j2+j3)* ...
    factorial(-j1+j2+j3)/factorial(j1+j2+j3+1)* ...
    factorial(j3+m3)*factorial(j3-m3)*factorial(j1+m1)* ...
    factorial(j1-m1)*factorial(j2+m2)*factorial(j2-m2));
cg=pref*sumTerm;
end
